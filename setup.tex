%-----------------------------------------------------------------
% Documento escrito por Fábio Dias (IST) e Beatriz Vieira (ISEG)
%-----------------------------------------------------------------
\usepackage[table,xcdraw]{xcolor}
\usepackage[portuguese]{babel}
\usepackage[normalem]{ulem}
\usepackage{anyfontsize}
\usepackage{mathtools}
\usepackage{setspace}
\usepackage{hyperref}
\usepackage{ragged2e}
\usepackage{graphicx}
\usepackage{titlesec}
\usepackage{fancyhdr}
\usepackage{listings}
\usepackage{fontspec}
\usepackage{caption}
\usepackage{vmargin}
\usepackage{tocloft}
\usepackage{wrapfig}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{siunitx}
\usepackage{parskip}
\usepackage{lipsum}
\usepackage{subfig}
\usepackage{float}
\usepackage{xfrac}
\usepackage{tikz}
\usepackage{url}

\setsansfont{Arial}
%Isto é para definir o tipo de letra das sections
\setmainfont{Times New Roman}
%Isto é para definir o tipo de letra
\setmathtt{Arial.ttf}
%Isto é para definir o tipo de letra em modo matemático
\sisetup{group-minimum-digits = 100}
\sisetup{output-decimal-marker = {,}}
%Isto é para o comando \SI{}{}
\setmarginsrb{2 cm}{1 cm}{2 cm}{2 cm}{0.5 cm}{0.5 cm}{1.5 cm}{1 cm}
%Isto é para definir os tamanhos das margens
\onehalfspacing
%Distancias entre rodapé e cabeçalho

\fancypagestyle{date}{\renewcommand{\headrulewidth}{0pt}\fancyhf{}\fancyfoot[C]{\today}}
%Isto é para pôr a data automaticamente na capa

\fancypagestyle{paging}{\renewcommand{\headrulewidth}{0pt}\fancyhf{}\fancyfoot[C]{\footnotesize Página \thepage}}
%Isto é para definir o estilo da paginação do documento e a sua localização na página

\addto\captionsportuguese{\renewcommand{\contentsname}{\fontsize{14}{6}\sffamily{Índice}}}
%Isto é para mudar o título do índice
\addto\captionsportuguese{\renewcommand{\refname}{}}
%Isto é para alterar o título "Referências" que aparece originalmente associada a \begin{thebibliography}, em branco omite o título

\renewcommand\thesection{\Roman{section}.}
\renewcommand\thesubsection{\thesection\arabic{subsection}.}
\renewcommand\thesubsubsection{\thesubsection\arabic{subsubsection}.}
%Definição da numeração das sections e subsections, ver mais aqui https://tex.stackexchange.com/questions/3177/how-to-change-the-numbering-of-part-chapter-section-to-alphabetical-r

\titlespacing\section{0pt}{1cm}{0.423cm}
\titleformat{\section}{\bfseries\fontsize{14}{6}\sffamily}{\thesection\:\:}{0pt}{}
%Isto é para os títulos das secções do trabalho
\titlespacing\subsection{0pt}{1cm}{0.423cm}
\titleformat{\subsection}{\bfseries\fontsize{14}{6}\sffamily}{\thesubsection\:\:}{0pt}{}
%Isto é para os títulos das subsecções do trabalho
\titlespacing\subsubsection{0pt}{1cm}{0.423cm}
\titleformat{\subsubsection}{\bfseries\fontsize{14}{6}\sffamily}{\thesubsubsection\:\:}{0pt}{}
%Isto é para os títulos das subsubsecções do trabalho

\captionsetup{labelsep=endash}
%Isto define que as \caption fiquem do tipo "Fig. X - <caption>"
\addto\captionsportuguese{\renewcommand{\figurename}{Fig.}}
%Estipula a legenda das figuras como sendo "Fig. X"
\addto\captionsportuguese{\renewcommand{\tablename}{Tab.}}
%Estipula a legenda das tabelas como sendo "Tab. X"

\DeclareUrlCommand{\bulurl}{\hspace{2mm}\footnotesize\def\UrlFont{\color{blue}\ulined}}\useunder{\uline}{\ulined}{}
%Criação de um comando para meter o link com hiperligação e a azul

\addtocontents{toc}{\protect\thispagestyle{paging}}
%\tocloftpagestyle{paging}
%Isto garante que o índice tem o devido rodapé (usar um quando o outro não funciona e vice-versa)

\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
%Isto põe os pontinhos no índice

\renewcommand{\cftsecpagefont}{\normalfont}
\renewcommand{\cftsecfont}{\normalfont}
%Isto tira os negritos no índice

\addtolength{\cftsubsubsecnumwidth}{1mm}
\addtolength{\cftsubsecnumwidth}{1mm}
\addtolength{\cftsecnumwidth}{1mm}
%Isto define a distância entre os números e o títulos no índice

\lstset{escapeinside={(*@}{@*)}}
\lstset{numbers=left, numberstyle=\tiny, stepnumber=1, numbersep=5pt}
%Numeração das linhas de código